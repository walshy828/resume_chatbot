<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Resume Chatbot{% endblock %}</title>

    <!-- TailwindCSS v4 CDN -->
    <script src="https://cdn.tailwindcss.com?plugins=typography"></script>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Outfit:wght@400;500;600;700&display=swap"
        rel="stylesheet">

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- TailwindCSS Configuration -->
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        display: ['Outfit', 'sans-serif'],
                    },
                    colors: {
                        primary: {
                            50: '#eff6ff',
                            100: '#dbeafe',
                            200: '#bfdbfe',
                            300: '#93c5fd',
                            400: '#60a5fa',
                            500: '#3b82f6',
                            600: '#2563eb',
                            700: '#1d4ed8',
                            800: '#1e40af',
                            900: '#1e3a8a',
                        },
                    },
                },
            },
        }
    </script>

    <style>
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }

        .dark ::-webkit-scrollbar-thumb {
            background: #475569;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        .dark ::-webkit-scrollbar-thumb:hover {
            background: #64748b;
        }
    </style>

    {% block extra_head %}{% endblock %}
</head>

<body class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 transition-colors duration-200">
    <!-- Flash Messages -->
    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
    <div class="fixed top-4 right-4 z-50 space-y-2">
        {% for category, message in messages %}
        <div class="bg-white dark:bg-gray-800 border-l-4 
                        {% if category == 'success' %}border-green-500{% elif category == 'error' %}border-red-500{% elif category == 'warning' %}border-yellow-500{% else %}border-blue-500{% endif %}
                        rounded-lg shadow-lg p-4 max-w-md animate-slide-in">
            <div class="flex items-start">
                <div class="flex-shrink-0">
                    {% if category == 'success' %}
                    <i data-lucide="check-circle" class="w-5 h-5 text-green-500"></i>
                    {% elif category == 'error' %}
                    <i data-lucide="x-circle" class="w-5 h-5 text-red-500"></i>
                    {% elif category == 'warning' %}
                    <i data-lucide="alert-triangle" class="w-5 h-5 text-yellow-500"></i>
                    {% else %}
                    <i data-lucide="info" class="w-5 h-5 text-blue-500"></i>
                    {% endif %}
                </div>
                <div class="ml-3">
                    <p class="text-sm font-medium">{{ message }}</p>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% endif %}
    {% endwith %}

    <script>
        // Auto-dismiss flash messages
        document.addEventListener('DOMContentLoaded', () => {
            const alerts = document.querySelectorAll('.animate-slide-in');
            alerts.forEach(alert => {
                // Add explicit close button or just click entire alert to dismiss? 
                // Using click entire alert for simplicity as requested "users can dismiss"
                alert.style.cursor = 'pointer';
                alert.addEventListener('click', () => {
                    alert.style.opacity = '0';
                    setTimeout(() => alert.remove(), 300);
                });

                // Auto dismiss
                setTimeout(() => {
                    if (document.body.contains(alert)) {
                        alert.style.opacity = '0';
                        alert.style.transition = 'opacity 0.3s ease-out';
                        setTimeout(() => alert.remove(), 300);
                    }
                }, 3000);
            });
        });
    </script>

    {% block content %}{% endblock %}

    <!-- Theme Detection Script -->
    <script>
        // Detect system theme preference
        function detectTheme() {
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        }

        // Initial detection
        detectTheme();

        // Listen for system theme changes
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', detectTheme);

        // Initialize Lucide icons
        document.addEventListener('DOMContentLoaded', () => {
            lucide.createIcons();
        });
    </script>

    {% block extra_scripts %}{% endblock %}
</body>

</html>